<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Document</title>
	<link href="styles/base.css" type="text/css" rel="stylesheet">
	<link href="styles/page/zs.css" type="text/css" rel="stylesheet">
	<script type="text/javascript" src="scripts/lib/jquery-1.9.1.min.js"></script>
	<script type="text/javascript" src="scripts/lib/jquery-ui.min.js"></script>
	<script type="text/javascript" src="scripts/lib/bootstrap.min.js"></script>
	<script type="text/javascript" src="scripts/lib/giui.min.js"></script>
	<script type="text/javascript" src="scripts/page/pagewrapper.js"></script>
	<script type="text/javascript" src="scripts/page/url.js"></script>
</head>
<body>
	<!--***top start****************************************-->
	<div id="youi_page_header" class="youi-page-header clearfix"></div>
	<!--***top end****************************************-->
	<div class="w100">
		<div class="w1200 clearfix pt30 pb50">
            <div style="width:1000px;margin:0px auto;">
                <div class="h-nav clearfix" style="margin-bottom:20px;">
                     <a href=""><span>航程信息</span></a> <font class="c-333 f12 fl ml10 mr10">|</font>
                    <a href=""><span class="current">去程</span></a>
                </div>
                <div class="clearfix hc-con-h" >
                    <table id="flightInfo">
                        <tr>
                            <td class="c-333">北京————上海</td>
                            <td class="c-333">四川航空3u8421</td>
                            <td>起飞：北京首都机场</td>
                            <td>票价：<span class="c-o">￥3840</span></td>
                        </tr>
                         <tr>
                            <td>2016-01-29 10:55:00</td>
                            <td>机型 : 320</td>
                            <td>抵达：上海虹桥机场</td>
                            <td>税费：<span class="c-o">¥50</span></td>
                        </tr>
                    </table>
                    <a href=""><div class="hch-pa">重新选择航班</div></a>
                </div>
                <div class="hc-con-c mt20">
                    <p class="c-333 mb10">退改签规则：</p>
                    <p>取消座位时间计算手续费;按照当前舱位票面价收取退票费;起飞前2.0小时（含）以外免收退票费,起飞前2.0小时以内及起飞后收取当前舱位票面价的10.0%退票费;可以改签;</p>
                </div>
                <div class="hc-con-infor mt20">
                    <div class="clearfix">
                        <h3 class="c-o f16">乘机人信息：</h3>
                        <div class="hcc-line" id="pass_info">
                            <p>乘机人姓名：<font class="f24">阿达</font></p>
                            <p>证件号码：<font class="f24">340222199208026911</font></p>
                            <p>证件类型：身份证</p>
                            <p>乘客类型：成人</p>
                            <p>乘客生日：1992-08-02</p>
                            <p>保险：航空意外险： 阿达（1份 ）  </p>
                        </div>
                    </div>
                    <div class="clearfix mt20 pt20" style="border-top:1px solid #efecec;">
                        <h3 class="c-o f16 mb20">联系人信息 ：</h3>
                        <div class="hcc-line" id="link_info">
                            <p>姓名：阿萨斯的</p>
                            <p>手机号码：18688829610</p>
                            <p>电子邮箱：435161289@qq.com</p>
                            <p>发票：需要发票</p>
                        </div>
                    </div>
                </div>
                <div class="clearfix hc-con-h mt20 tr" >
                    <a href="javascript:;" class="ib-btn fl" id="prev_edit" style="margin:10px 20px;">上一步</a>
                    <span>共<font class="c-o"> 1 </font>名乘机人 订单总计费用：<font class="c-o f24">1300</font></span>
                    <a href="javascript:;" class="ib-btn" style="margin:10px 20px;">提交订单</a>
                </div>
            </div>
		</div>
	</div>
	<!--***bottom start****************************************-->
	<div id="youi_page_footer" class="youi-page-footer"></div>
	<!--***bottom end****************************************-->
	<script type="text/javascript">
	//获取请求URL
	function GetRequest() {
		/* url=decodeURI(location.href);
		var tmp1=url.split("?")[1]; */
	   var url = decodeURI(location.search); //获取url中"?"符后的字串
			   alert(url);
	   var theRequest = new Object();
	   if (url.indexOf("?") != -1) {
	      var str = url.substr(1);
	      strs = str.split("&");
	      for(var i = 0; i < strs.length; i ++) {
	         theRequest[strs[i].split("=")[0]]=(strs[i].split("=")[1]);
	      }
	   }
	   return theRequest;
	}
	$(function(){
		var Request = new Object();
		Request = GetRequest();
		//["flightNo","planeType","orgCity","arrCity","depTime","arriTime","meal","airportTax","seatCode","parPrice","seatMsg","policyId"];
		var segments = [{"flightNo":Request['flightNo'],"depCode":Request['depCode'],"arrCode":Request['arrCode'],"seatClass":Request['seatClass'],
			"depDate":Request['depDate'],"depTime":Request['depTime'],"arrTime":Request['arrTime'],"planeModel":Request['planeType']}];
		var passengers = [{"name":Request['passengerName'],"type":Request['passengerType'],"identityType":Request['identityType'],"identityNo":Request['identityNo'],"birthday":""}];
		var pnrInfo = {"segments":segments,"passengers":passengers,
				"parPrice":Request['parPrice'],"fuelTax":Request['fuelTax'],"airportTax":Request['airportTax']};
		var params = ['policyId='+Request['policyId'],'linkMan='+Request['linkMan'],'linkPhone='+Request['linkPhone'],
		              'otherLinkMethod='+Request['otherLinkMethod']];
		var serviceURL = baseUrl+"TicketServiceManager/bookTicket.json";
		$.youi.ajaxUtils.ajax({
			url:serviceURL,
			data:params.join('&'),
			jsonp:'data:jsonp',
			dataType:'jsonp',
			success:function(result){
				
			}
		})
		//航程信息
		var html_ = "<tr><td class='c-333'>" +Request['fromcity']+ "————" +Request['gotocity']+ "</td>";
		html_ += "<td class='c-333'>"+Request['flightNo']+"</td>";
		html_ += "<td>起飞："+Request['orgCity']+"</td>";
		html_ += "<td>票价：<span class='c-o'>￥"+Request['parPrice']+"</span></td></tr>";
        html_ += "<tr><td>"+Request['gotoCode']+" "+Request['depTime']+"</td>";
        html_ += "<td>机型 : "+Request['planeType']+"</td>";
        html_ += "<td>抵达："+Request['arrCity']+"</td>";
        html_ += "<td>机建费：<span class='c-o'>¥ "+Request['airportTax']+"</span></td></tr>";
        $("#flightInfo").empty();
        $("#flightInfo").append(html_);
		//乘机人信息
		/* <div class="hcc-line">
                            <p>乘机人姓名：<font class="f24">阿达</font></p>
                            <p>证件号码：<font class="f24">340222199208026911</font></p>
                            <p>证件类型：身份证</p>
                            <p>乘客类型：成人</p>
                            <p>乘客生日：1992-08-02</p>
                            <p>保险：航空意外险： 阿达（1份 ）  </p>
                        </div> */
         var passengers = Request['passengers'].split(":"),
             pass_html="";
             
             for(var i=0,len=passengers.length;i<len;i++){
            	 var pass_info = passengers[i].split("-");
            	 pass_html+="<div class='pass_list'><p>乘机人姓名：<font class='f24'>"+pass_info[0]+"</font></p>"
            	            +"<p>证件号码：<font class='f24'>"+pass_info[1]+"</font></p>"
                            +"<p>乘客类型："+(pass_info[2]=="CHD"?"儿童":"成人")+"</p>"
            	            +"</div>";
             }
             //alert(passengers)
         $("#pass_info").html(pass_html);
        //联系人信息
		var linkMan = Request['linkMan'].split("-"); 
        var link_html = "<p>姓名："+linkMan[0]+"</p>"+
                        "<p>手机号码："+linkMan[1]+"</p>";
        if(linkMan[2]!="null"){
        	link_html+="<p>电话："+linkMan[2]+"</p>";
        }
        if(linkMan[3]!="null"){
        	link_html+="<p>电子邮箱："+linkMan[3]+"</p>"
        }
        $("#link_info").html(link_html);
        
		//上一步
		$("#prev_edit").on("click",function(){
			window.location.href="hcxx-edit.html"+window.location.href.substring(window.location.href.indexOf("?"))
		})
	});
	</script>
</body>
</html>